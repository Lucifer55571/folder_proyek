<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        #bg-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            object-fit: cover;
            z-index: -1;
        }


    </style>
    <title>Flame-Chasers Cryptography</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>

<body>

<audio id="bg-music" loop preload="auto">
    <source src="{{ url_for('static', filename='sources/Moon_Halo.mp3') }}" type="audio/mpeg">
</audio>

<div class="music-marquee" id="musicToggle">
    <div class="marquee-text">
        ▶ PLAY MUSIC — MOON HALO • HONKAI IMPACT 3RD •
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const audio = document.getElementById("bg-music");
    const marquee = document.getElementById("musicToggle");
    const text = marquee.querySelector(".marquee-text");

    let isPlaying = false;

    marquee.addEventListener("click", async () => {
        try {
            if (!isPlaying) {
                await audio.play();
                text.textContent = "⏸ NOW PLAYING — MOON HALO • HONKAI IMPACT 3RD •";
            } else {
                audio.pause();
                text.textContent = "▶ PLAY MUSIC — MOON HALO • HONKAI IMPACT 3RD •";
            }
            isPlaying = !isPlaying;
        } catch (e) {
            alert("Klik sekali lagi untuk mengaktifkan audio");
        }
    });
});
</script>

    <video autoplay muted loop playsinline id="bg-video">
        <source src="static/sources/aedes_elysiae.mp4" type="video/mp4">
    </video>

    <div class="content py-5">

    <a class="char-link kevin-box" target="_blank" href="https://honkaiimpact3.hoyoverse.com/asia/id-id/news/107292?source=v1">
        <img class="character kevin" src="{{ url_for('static', filename='sources/Kevin_Kaslana.webp') }}">
    </a>

    <a class="char-link phainon-box" target="_blank" href="https://honkai-star-rail.fandom.com/wiki/Chrysos_Heirs">
        <img class="character2 phainon" src="{{ url_for('static', filename='sources/Phainon.webp') }}">
    </a>


        <div class="text-center mb-5 fade-in">
            <h1 class="app-title" data-text="FLAME-CHASERS CRYPTOGRAPHY">FLAME-CHASERS CRYPTOGRAPHY </h1>
            <p class="author-text">BY: LUCIFER18 | ROSYID KHOIRUDIN 24.83.1103</p>
        </div>

        <div class="row justify-content-center">
            <div class="col-md-8 fade-in">
                <div class="card shadow">
                    <div class="card-body p-4">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Metode Enkripsi:</label>
                                <select id="mode" class="form-select">
                                    <option value="1">Encrypt /8 (Mudah)</option>
                                    <option value="2">Encrypt Sempurna</option>
                                    <option value="3">Encrypt Singkat</option>
                                    <option value="4">Encrypt Enigma</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3 d-none" id="enigma-section">
                                <label class="form-label">Pattern Enigma:</label>
                                <select id="enigma_p" class="form-select">
                                    {% for k, v in patterns.items() %}
                                    <option value="{{ k }}">Pattern {{ k }} ({{ v|join('-') }})</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Input Plaintext/Ciphertext:</label>
                            <textarea id="inputText" class="form-control" rows="4" placeholder="Ketik pesan rahasia di sini..."></textarea>
                        </div>

                        <div class="d-flex gap-3 mb-4">
                            <button onclick="handleProcess('encrypt')" class="btn btn-primary flex-fill py-2">
                                ENCRYPT MESSAGE
                            </button>
                            <button onclick="handleProcess('decrypt')" class="btn btn-outline-info flex-fill py-2">
                                DECRYPT MESSAGE
                            </button>
                        </div>

                        <div class="result-container">
                            <label class="form-label">Result Output:</label>
                            <button onclick="copyToClipboard()" class="btn btn-sm btn-outline-light copy-btn" id="copyBtn">
                                Copy
                            </button>
                            <div id="result" class="result-box">---</div>
                        </div>

                        <div class="mt-3 text-end">
                            <button onclick="clearAll()" class="btn btn-sm btn-link text-secondary text-decoration-none">Clear All</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('mode').addEventListener('change', function() {
            const enigmaSec = document.getElementById('enigma-section');
            if(this.value === "4") {
                enigmaSec.classList.remove('d-none');
                enigmaSec.classList.add('fade-in');
            } else {
                enigmaSec.classList.add('d-none');
            }
        });

        async function handleProcess(action) {
            const text = document.getElementById('inputText').value;
            if (!text.trim()) {
                alert("Masukkan teks terlebih dahulu!");
                return;
            }

            const data = {
                action: action,
                mode: document.getElementById('mode').value,
                text: text,
                enigma_p: document.getElementById('enigma_p').value
            };

            const response = await fetch('/process', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const result = await response.json();
            const resultDiv = document.getElementById('result');
            resultDiv.innerText = result.result || "Error: No result found.";
        }

        function copyToClipboard() {
            const resultText = document.getElementById('result').innerText;
            if (resultText === "---" || resultText === "") return;

            navigator.clipboard.writeText(resultText).then(() => {
                const btn = document.getElementById('copyBtn');
                btn.innerText = "✓ Copied!";
                btn.className = "btn btn-sm btn-success copy-btn";
                setTimeout(() => {
                    btn.innerText = "Copy";
                    btn.className = "btn btn-sm btn-outline-light copy-btn";
                }, 2000);
            });
        }

        function clearAll() {
            document.getElementById('inputText').value = "";
            document.getElementById('result').innerText = "---";
        }
    </script>
</body>

 </html>
